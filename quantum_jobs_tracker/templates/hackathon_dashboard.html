<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Spark - Amaravathi Quantum Hackathon Dashboard</title>
    
    <!-- Professional Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Bloch Sphere Styles -->
    <link rel="stylesheet" href="/static/bloch_sphere/main.css">

    <!-- Plotly for 3D visualizations -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    
    <!-- Sortable.js for drag and drop -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    
    <!-- Google Gemini AI -->
    <script src="https://unpkg.com/@google/generative-ai@0.1.3/dist/index.js"></script>

    <!-- Offline Manager for offline functionality -->
    <script src="{{ url_for('static', filename='offline_manager.js') }}"></script>

    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --ocean-gradient: linear-gradient(135deg, #0c4a6e 0%, #0369a1 50%, #0284c7 100%);
            --quantum-gradient: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #06b6d4 100%);
            --success-gradient: linear-gradient(135deg, #059669 0%, #10b981 100%);
            --warning-gradient: linear-gradient(135deg, #d97706 0%, #f59e0b 100%);
            --danger-gradient: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
            --background-gradient: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            --surface-gradient: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-accent: #06b6d4;
            --shadow-glow: 0 0 20px rgba(6, 182, 212, 0.3);
            --shadow-deep: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            --border-radius: 12px;
            --font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-mono: 'JetBrains Mono', 'Fira Code', monospace;
            --font-display: 'Orbitron', monospace;
        }

        /* Enhanced AI Spinner Animation */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .spinner {
            border: 2px solid rgba(6, 182, 212, 0.3);
            border-top: 2px solid var(--text-accent);
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            background: var(--background-gradient);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Animated Background */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: var(--background-gradient);
        }

        .animated-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 80%, rgba(6, 182, 212, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(139, 92, 246, 0.1) 0%, transparent 50%);
            animation: float 20s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-20px) rotate(1deg); }
            66% { transform: translateY(10px) rotate(-1deg); }
        }

        /* Header */
        .header {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-deep);
            position: sticky;
            top: 0;
            z-index: 100;
            min-height: 80px;
            width: 100%;
            box-sizing: border-box;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-shrink: 1;
            min-width: 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-shrink: 1;
            min-width: 0;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: var(--quantum-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            box-shadow: var(--shadow-glow);
            animation: pulse 2s ease-in-out infinite;
            flex-shrink: 0;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .logo-text {
            min-width: 0;
            flex-shrink: 1;
        }

        .logo-text h1 {
            font-family: var(--font-display);
            font-size: 1.8rem;
            font-weight: 900;
            background: var(--quantum-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .logo-text .subtitle {
            font-size: 0.9rem;
            color: var(--text-accent);
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .hackathon-badge {
            background: var(--success-gradient);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-size: 0.875rem;
            font-weight: 600;
            box-shadow: var(--shadow-glow);
            animation: glow 3s ease-in-out infinite;
            white-space: nowrap;
            flex-shrink: 0;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(16, 185, 129, 0.3); }
            50% { box-shadow: 0 0 30px rgba(16, 185, 129, 0.6); }
        }

        .header-center {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-shrink: 1;
            min-width: 0;
            justify-content: center;
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: var(--success-gradient);
            color: white;
            border-radius: 25px;
            font-size: 0.875rem;
            font-weight: 600;
            box-shadow: var(--shadow-glow);
            white-space: nowrap;
            flex-shrink: 1;
            min-width: 0;
            overflow: hidden;
        }

        .connection-status span {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .connection-status.disconnected {
            background: var(--danger-gradient);
        }

        .connection-status.warning {
            background: var(--warning-gradient);
        }

        .connection-status.offline {
            background: var(--danger-gradient);
        }

        .offline-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            padding: 15px 20px;
            box-shadow: var(--shadow-deep);
            z-index: 1000;
            max-width: 300px;
            animation: slideIn 0.3s ease-out;
            display: none;
        }

        .offline-notification.show {
            display: block;
        }

        .offline-notification.success {
            border-left: 4px solid #10b981;
        }

        .offline-notification.warning {
            border-left: 4px solid #f59e0b;
        }

        .offline-notification.error {
            border-left: 4px solid #ef4444;
        }

        .offline-notification .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 16px;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-shrink: 0;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 25px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--quantum-gradient);
            color: white;
            box-shadow: var(--shadow-glow);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(6, 182, 212, 0.4);
        }

        .btn-secondary {
            background: var(--glass-bg);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(10px);
        }

        .btn-secondary:hover {
            background: var(--glass-border);
            transform: translateY(-2px);
        }

        .btn-info {
            background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
            color: white;
            box-shadow: 0 0 20px rgba(6, 182, 212, 0.3);
        }

        .btn-info:hover {
            background: linear-gradient(135deg, #0891b2 0%, #06b6d4 100%);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(6, 182, 212, 0.4);
        }

        /* Notifications */
        .notification-container {
            position: fixed;
            top: 100px;
            right: 2rem;
            z-index: 1000;
            max-width: 400px;
        }

        .notification {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin-bottom: 0.5rem;
            box-shadow: var(--shadow-deep);
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            animation: slideIn 0.3s ease-out;
            position: relative;
        }

        .notification.success {
            border-left: 4px solid #10b981;
        }

        .notification.error {
            border-left: 4px solid #ef4444;
        }

        .notification.warning {
            border-left: 4px solid #f59e0b;
        }

        .notification.info {
            border-left: 4px solid #06b6d4;
        }

        .notification-close {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1rem;
            transition: color 0.2s ease;
        }

        .notification-close:hover {
            color: var(--text-primary);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Main Content */
        .main-content {
            padding: 2rem;
            max-width: 100vw;
            overflow-x: hidden;
            min-height: calc(100vh - 80px);
        }

        /* Metrics Overview */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .metric-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--shadow-deep);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--quantum-gradient);
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(6, 182, 212, 0.2);
        }

        .metric-value {
            font-family: var(--font-display);
            font-size: 2.5rem;
        }


        .metric-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Widget Grid */
        .widget-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .widget {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-deep);
            transition: all 0.3s ease;
            position: relative;
            min-height: 400px;
            overflow: hidden;
        }

        .widget::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--quantum-gradient);
        }

        .widget:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(6, 182, 212, 0.2);
        }

        .widget-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--glass-bg);
        }

        .widget-title {
            font-family: var(--font-display);
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .widget-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .widget-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: var(--glass-bg);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            transition: all 0.2s ease;
            border: 1px solid var(--glass-border);
        }

        .widget-btn:hover {
            background: var(--glass-border);
            color: var(--text-primary);
            transform: scale(1.1);
        }

        .widget-content {
            padding: 1.5rem;
            height: calc(100% - 80px);
            overflow: hidden;
        }

        /* Visualization Container */
        .visualization-container {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .visualization-container > div {
            width: 100%;
            height: 100%;
            max-width: 100%;
        }

        /* 3D Circuit specific styling */
        #circuit-3d-plot {
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin: 0 auto;
        }

        .circuit-3d-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .circuit-3d-view {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 300px;
        }

        /* Popup Modal */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .popup-modal {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-deep);
            width: 90vw;
            height: 90vh;
            max-width: 1200px;
            max-height: 800px;
            position: relative;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .popup-overlay.active .popup-modal {
            transform: scale(1);
        }

        .popup-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .popup-close {
            width: 40px;
            height: 40px;
            border: none;
            background: var(--danger-gradient);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            transition: all 0.2s ease;
        }

        .popup-close:hover {
            transform: scale(1.1);
        }

        .popup-content {
            padding: 1.5rem;
            height: calc(100% - 80px);
            overflow: auto;
        }

        /* Loading States */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 200px;
            color: var(--text-secondary);
            flex-direction: column;
            gap: 1rem;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--glass-border);
            border-top: 3px solid var(--text-accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Customization Panel */
        .customization-panel {
            position: fixed;
            top: 0;
            right: -450px;
            width: 450px;
            height: 100vh;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-left: 1px solid var(--glass-border);
            box-shadow: var(--shadow-deep);
            transition: right 0.3s ease;
            z-index: 1000;
            overflow-y: auto;
        }

        .customization-panel.open {
            right: 0;
        }

        .customization-header {
            padding: 2rem;
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .customization-content {
            padding: 2rem;
        }

        .widget-list {
            list-style: none;
        }

        .widget-item {
            padding: 1rem;
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            margin-bottom: 0.75rem;
            cursor: move;
            background: var(--glass-bg);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }

        .widget-item:hover {
            background: var(--glass-border);
            transform: translateX(5px);
        }

        /* AI Integration Panel */
        .ai-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-deep);
        }

        .ai-panel h3 {
            font-family: var(--font-display);
            color: var(--text-accent);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .ai-input {
            width: 100%;
            padding: 1rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            color: var(--text-primary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .ai-input::placeholder {
            color: var(--text-secondary);
        }

        /* Tutorial Responsive Design */
        @media (max-width: 1024px) {
            .tutorial-tooltip {
                min-width: 400px;
                max-width: 450px;
                padding: 1.5rem;
                font-size: 0.95rem;
            }

            .tutorial-title {
                font-size: 1.2rem;
            }

            .tutorial-content {
                font-size: 1rem;
            }

            .tutorial-btn {
                padding: 0.7rem 1.2rem;
                font-size: 0.95rem;
                min-width: 100px;
            }
        }

        @media (max-width: 768px) {
            .tutorial-tooltip {
                min-width: 320px;
                max-width: 380px;
                padding: 1.2rem;
                font-size: 0.9rem;
            }

            .tutorial-title {
                font-size: 1.1rem;
            }

            .tutorial-content {
                font-size: 0.95rem;
                margin-bottom: 1.5rem;
            }

            .tutorial-btn {
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
                min-width: 90px;
            }

            .tutorial-navigation {
                gap: 1rem;
            }
        }

        @media (max-width: 480px) {
            .tutorial-tooltip {
                min-width: 280px;
                max-width: 320px;
                padding: 1rem;
                font-size: 0.85rem;
            }

            .tutorial-title {
                font-size: 1rem;
            }

            .tutorial-content {
                font-size: 0.9rem;
                margin-bottom: 1.2rem;
            }

            .tutorial-btn {
                padding: 0.5rem 0.8rem;
                font-size: 0.85rem;
                min-width: 80px;
            }

            .tutorial-header {
                margin-bottom: 1rem;
                padding-bottom: 0.8rem;
            }

            .tutorial-step-counter {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .header {
                padding: 1rem 1.5rem;
            }

            .logo-text h1 {
                font-size: 1.6rem;
            }

            .connection-status {
                padding: 0.6rem 1.2rem;
                font-size: 0.8rem;
            }

            .hackathon-badge {
                padding: 0.4rem 0.8rem;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 1024px) {
            .header-center {
                gap: 0.75rem;
            }

            .logo-text h1 {
                font-size: 1.5rem;
            }

            .header-right {
                gap: 0.25rem;
            }

            .btn {
                padding: 0.6rem 1.2rem;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 0.75rem 1rem;
                flex-direction: column;
                gap: 0.75rem;
                min-height: auto;
            }

            .header-left {
                width: 100%;
                justify-content: center;
            }

            .header-center {
                order: -1;
                width: 100%;
                justify-content: center;
                gap: 0.5rem;
                flex-wrap: wrap;
            }

            .header-right {
                width: 100%;
                justify-content: center;
                gap: 0.25rem;
                flex-wrap: wrap;
            }

            .logo {
                gap: 0.5rem;
            }

            .logo-icon {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }

            .logo-text h1 {
                font-size: 1.3rem;
            }

            .logo-text .subtitle {
                font-size: 0.8rem;
            }

            .connection-status {
                padding: 0.5rem 1rem;
                font-size: 0.75rem;
                flex-shrink: 1;
                min-width: 120px;
            }

            .hackathon-badge {
                padding: 0.3rem 0.6rem;
                font-size: 0.75rem;
                flex-shrink: 1;
            }

            .btn {
                padding: 0.5rem 1rem;
                font-size: 0.75rem;
                flex-shrink: 1;
                min-width: 80px;
            }

            .btn span {
                display: none;
            }

            .main-content {
                padding: 1rem;
            }

            .widget-grid {
                grid-template-columns: 1fr;
            }

            .customization-panel {
                width: 100vw;
                right: -100vw;
            }

            .popup-modal {
                width: 95vw;
                height: 95vh;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 0.5rem 0.75rem;
                gap: 0.5rem;
            }

            .header-left,
            .header-center,
            .header-right {
                gap: 0.25rem;
            }

            .logo-icon {
                width: 36px;
                height: 36px;
                font-size: 1rem;
            }

            .logo-text h1 {
                font-size: 1.1rem;
            }

            .logo-text .subtitle {
                font-size: 0.7rem;
            }

            .connection-status {
                padding: 0.4rem 0.8rem;
                font-size: 0.7rem;
                min-width: 100px;
            }

            .hackathon-badge {
                padding: 0.25rem 0.5rem;
                font-size: 0.7rem;
            }

            .btn {
                padding: 0.4rem 0.8rem;
                font-size: 0.7rem;
                min-width: 70px;
            }

            .main-content {
                padding: 0.75rem;
            }
        }

        /* Chat Interface Styles */
        .chat-container {
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            max-height: 200px;
        }

        .message {
            margin-bottom: 0.75rem;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .ai-message {
            justify-content: flex-start;
        }

        .user-message {
            justify-content: flex-end;
        }

        .message-content {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 0.75rem;
            max-width: 80%;
            font-size: 0.875rem;
            line-height: 1.4;
        }

        .ai-message .message-content {
            background: var(--quantum-gradient);
            color: white;
        }

        .user-message .message-content {
            background: var(--glass-bg);
            color: var(--text-primary);
        }

        .chat-input-container {
            display: flex;
            gap: 0.5rem;
            padding: 1rem;
            border-top: 1px solid var(--glass-border);
        }

        .chat-input {
            flex: 1;
            padding: 0.75rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.875rem;
        }

        .chat-input::placeholder {
            color: var(--text-secondary);
        }

        .send-btn {
            padding: 0.75rem;
            background: var(--quantum-gradient);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .send-btn:hover {
            transform: scale(1.05);
        }

        /* Animation Classes */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-up {
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Tutorial System Styles */
        .tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            z-index: 3000;
            display: none;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .tutorial-overlay.active {
            display: block;
            opacity: 1;
        }

        .tutorial-highlight {
            position: absolute;
            background: rgba(6, 182, 212, 0.4);
            border: 3px solid #06b6d4;
            border-radius: 12px;
            box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.85), 0 0 0 0 15px rgba(6, 182, 212, 0.6);
            z-index: 3001;
            pointer-events: none;
            animation: tutorial-pulse 2s ease-in-out infinite;
        }

        @keyframes tutorial-pulse {
            0%, 100% {
                box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.85), 0 0 0 0 15px rgba(6, 182, 212, 0.4), 0 0 25px rgba(6, 182, 212, 0.5);
            }
            50% {
                box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.85), 0 0 0 0 20px rgba(6, 182, 212, 0.7), 0 0 40px rgba(6, 182, 212, 0.8);
            }
        }

        .tutorial-tooltip {
            position: absolute;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(25px);
            border: 2px solid rgba(6, 182, 212, 0.5);
            border-radius: 16px;
            padding: 2rem;
            min-width: 450px;
            max-width: 550px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(6, 182, 212, 0.3);
            z-index: 3002;
            font-size: 1rem;
            line-height: 1.6;
            opacity: 0;
            transform: scale(0.9) translateY(30px);
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            pointer-events: auto;
        }

        .tutorial-tooltip.active {
            opacity: 1;
            transform: scale(1) translateY(0);
        }

        .tutorial-tooltip::before {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border: 12px solid transparent;
        }

        .tutorial-tooltip.top::before {
            border-bottom-color: rgba(15, 23, 42, 0.95);
            border-top: none;
            top: -24px;
            left: 50%;
            transform: translateX(-50%);
        }

        .tutorial-tooltip.bottom::before {
            border-top-color: rgba(15, 23, 42, 0.95);
            border-bottom: none;
            bottom: -24px;
            left: 50%;
            transform: translateX(-50%);
        }

        .tutorial-tooltip.left::before {
            border-right-color: rgba(15, 23, 42, 0.95);
            border-left: none;
            left: -24px;
            top: 50%;
            transform: translateY(-50%);
        }

        .tutorial-tooltip.right::before {
            border-left-color: rgba(15, 23, 42, 0.95);
            border-right: none;
            right: -24px;
            top: 50%;
            transform: translateY(-50%);
        }

        .tutorial-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(6, 182, 212, 0.3);
        }

        .tutorial-title {
            font-family: var(--font-display);
            font-size: 1.4rem;
            font-weight: 700;
            color: #06b6d4;
            margin: 0;
            text-shadow: 0 2px 4px rgba(6, 182, 212, 0.3);
        }

        .tutorial-step-counter {
            font-size: 0.9rem;
            color: #cbd5e1;
            font-weight: 600;
            background: rgba(6, 182, 212, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            border: 1px solid rgba(6, 182, 212, 0.3);
        }

        .tutorial-content {
            color: #f1f5f9;
            margin-bottom: 2rem;
            font-size: 1.1rem;
            line-height: 1.7;
        }

        .tutorial-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1.5rem;
        }

        .tutorial-btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            min-width: 120px;
            justify-content: center;
        }

        .tutorial-btn.primary {
            background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(6, 182, 212, 0.4);
        }

        .tutorial-btn.primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(6, 182, 212, 0.6);
        }

        .tutorial-btn.secondary {
            background: rgba(30, 41, 59, 0.8);
            color: #f1f5f9;
            border: 2px solid rgba(6, 182, 212, 0.3);
            backdrop-filter: blur(10px);
        }

        .tutorial-btn.secondary:hover {
            background: rgba(6, 182, 212, 0.2);
            border-color: rgba(6, 182, 212, 0.6);
            transform: translateY(-2px);
        }

        .tutorial-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        .tutorial-progress {
            flex: 1;
            height: 8px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 4px;
            overflow: hidden;
            border: 1px solid rgba(6, 182, 212, 0.2);
        }

        .tutorial-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #06b6d4 0%, #0891b2 50%, #06b6d4 100%);
            border-radius: 4px;
            transition: width 0.4s ease;
            box-shadow: 0 0 10px rgba(6, 182, 212, 0.5);
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="animated-bg"></div>

    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-atom"></i>
                </div>
                <div class="logo-text">
                    <h1>Quantum Spark</h1>
                    <div class="subtitle">Amaravathi Quantum Hackathon</div>
                </div>
            </div>
        </div>
        
        <div class="header-center">
            <div class="hackathon-badge">
                <i class="fas fa-trophy"></i>
                Amaravathi Quantum Hackathon 2025
            </div>
            <div class="connection-status" id="connection-status">
                <i class="fas fa-circle"></i>
                <span>Connected to IBM Quantum</span>
            </div>
        </div>
        
        <div class="header-right">
            <button class="btn btn-secondary theme-switcher-btn" id="theme-switcher-btn">
                <i class="fas fa-palette"></i>
                <span>Theme</span>
            </button>
            <button class="btn btn-info" id="tutorials-btn">
                <i class="fas fa-question-circle"></i>
                Tutorials
            </button>
            <button class="btn btn-secondary" id="customize-btn">
                <i class="fas fa-cog"></i>
                Customize
            </button>
            <button class="btn btn-primary" id="refresh-all-btn">
                <i class="fas fa-sync-alt"></i>
                Refresh All
            </button>
        </div>
    </header>

    <!-- Notifications Container -->
    <div class="notification-container" id="notification-container"></div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- AI Integration Panel -->
        <div class="ai-panel fade-in">
            <h3>
                <i class="fas fa-robot"></i>
                Google Gemini AI Assistant
            </h3>
            <input type="text" class="ai-input" id="ai-input" placeholder="Ask Gemini AI about quantum states, circuits, or any quantum computing topic...">
            <div id="ai-response" style="color: var(--text-secondary); font-size: 0.875rem;"></div>
        </div>

        <!-- Metrics Overview -->
        <section class="metrics-grid slide-up">
            <div class="metric-card">
                <div class="metric-label">Active Backends</div>
                <div class="metric-value" id="active-backends">-</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Total Jobs</div>
                <div class="metric-value" id="total-jobs">-</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Running Jobs</div>
                <div class="metric-value" id="running-jobs">-</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Success Rate</div>
                <div class="metric-value" id="success-rate">-</div>
            </div>
        </section>

        <!-- Widget Grid -->
        <div class="widget-grid" id="widget-grid">
            <!-- Quantum Backends Widget -->
            <div class="widget fade-in" data-widget="backends">
                <div class="widget-header">
                    <h3 class="widget-title">
                        <i class="fas fa-server"></i>
                        Quantum Backends
                    </h3>
                    <div class="widget-controls">
                        <button class="widget-btn" data-action="refresh" title="Refresh">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="popup" title="Popup View">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="widget-btn" data-action="fullscreen" title="Fullscreen">
                            <i class="fas fa-external-link-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="remove" title="Remove">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="widget-content">
                    <div class="loading" id="backends-loading">
                        <div class="spinner"></div>
                        <span>Loading quantum backends...</span>
                    </div>
                    <div id="backends-content" style="display: none;">
                        <!-- Backends content will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Quantum Jobs Widget -->
            <div class="widget fade-in" data-widget="jobs">
                <div class="widget-header">
                    <h3 class="widget-title">
                        <i class="fas fa-tasks"></i>
                        Quantum Jobs
                    </h3>
                    <div class="widget-controls">
                        <button class="widget-btn" data-action="add-api" title="Add API Instance">
                            <i class="fas fa-plus-circle"></i>
                        </button>
                        <button class="widget-btn" data-action="refresh" title="Refresh">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="popup" title="Popup View">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="widget-btn" data-action="fullscreen" title="Fullscreen">
                            <i class="fas fa-external-link-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="remove" title="Remove">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="widget-content">
                    <div class="loading" id="jobs-loading">
                        <div class="spinner"></div>
                        <span>Loading quantum jobs...</span>
                    </div>
                    <div id="jobs-content" style="display: none;">
                        <!-- Jobs content will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- 3D Bloch Sphere Widget (Advanced Implementation) -->
            <div class="widget fade-in" data-widget="bloch-sphere">
                <div class="widget-header">
                    <h3 class="widget-title">
                        <i class="fas fa-globe"></i>
                        3D Bloch Sphere (Advanced)
                    </h3>
                    <div class="widget-controls">
                        <button class="widget-btn" data-action="refresh" title="Refresh">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="popup" title="Popup View">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="widget-btn" data-action="fullscreen" title="Fullscreen">
                            <i class="fas fa-external-link-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="remove" title="Remove">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="widget-content">
                    <div class="loading" id="bloch-loading">
                        <div class="spinner"></div>
                        <span>Loading Advanced Bloch Sphere...</span>
                    </div>
                    <div class="visualization-container" id="bloch-content" style="display: block;">
                        <div class="bloch-sphere-widget" style="display: flex; height: 500px; background: #000; border-radius: 8px; overflow: hidden;">
                            <!-- Main Bloch Sphere View -->
                            <div class="bloch-main-view" style="flex: 1; position: relative; background: #000;">
                                <div id="bloch-sphere" style="width: 100%; height: 100%; position: relative;"></div>
                                
                                <!-- State Display (Bottom Left) -->
                                <div id="bloch-sphere-state" style="position: absolute; bottom: 10px; left: 10px; background: rgba(0,0,0,0.8); color: white; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px; line-height: 1.4;">
                                    <div>Theta: <span id="bloch-sphere-state-theta">+0.0000</span></div>
                                    <div>Phi: <span id="bloch-sphere-state-phi">+90.0000</span></div>
                                    <div>Alpha: <span id="bloch-sphere-state-alpha">+1.0000</span></div>
                                    <div>Beta: <span id="bloch-sphere-state-beta">+0.0000 + i * 0.0000</span></div>
                                    <div style="margin-top: 5px; border-top: 1px solid #333; padding-top: 5px;">
                                        <div>X: <span id="bloch-sphere-state-x">+0.0000</span></div>
                                        <div>Y: <span id="bloch-sphere-state-y">+0.0000</span></div>
                                        <div>Z: <span id="bloch-sphere-state-z">+1.0000</span></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Toolbox Sidebar -->
                            <div class="bloch-toolbox" style="width: 250px; background: #1a1a1a; padding: 15px; overflow-y: auto; border-left: 1px solid #333;">
                                <h4 style="color: #fff; margin-bottom: 20px; font-family: Arial, sans-serif; font-size: 16px;">Toolbox</h4>

                                <!-- Half-turn Gates -->
                                <div style="margin-bottom: 20px;">
                                    <h5 style="color: #fff; margin-bottom: 10px; font-size: 14px;">Half-turn Gates</h5>
                                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 5px;">
                                        <button class="quantum-gate" id="px-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>x</sub></button>
                                        <button class="quantum-gate" id="py-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>y</sub></button>
                                        <button class="quantum-gate" id="pz-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>z</sub></button>
                                        <button class="quantum-gate" id="h-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">H</button>
                                    </div>
                                </div>

                                <!-- Quarter-turn Gates -->
                                <div style="margin-bottom: 20px;">
                                    <h5 style="color: #fff; margin-bottom: 10px; font-size: 14px;">Quarter-turn Gates</h5>
                                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 5px;">
                                        <button class="quantum-gate" id="px-12-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>x</sub><sup>1/2</sup></button>
                                        <button class="quantum-gate" id="py-12-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>y</sub><sup>1/2</sup></button>
                                        <button class="quantum-gate" id="pz-12-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>z</sub><sup>1/2</sup></button>
                                        <button class="quantum-gate" id="pxi-12-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>x</sub><sup>-1/2</sup></button>
                                        <button class="quantum-gate" id="pyi-12-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>y</sub><sup>-1/2</sup></button>
                                        <button class="quantum-gate" id="pzi-12-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>z</sub><sup>-1/2</sup></button>
                                        <button class="quantum-gate" id="s-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">S</button>
                                        <button class="quantum-gate" id="si-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">S<sup>-1</sup></button>
                                    </div>
                                </div>

                                <!-- Eighth-turn Gates -->
                                <div style="margin-bottom: 20px;">
                                    <h5 style="color: #fff; margin-bottom: 10px; font-size: 14px;">Eighth-turn Gates</h5>
                                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 5px;">
                                        <button class="quantum-gate" id="px-14-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>x</sub><sup>1/4</sup></button>
                                        <button class="quantum-gate" id="py-14-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>y</sub><sup>1/4</sup></button>
                                        <button class="quantum-gate" id="pz-14-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>z</sub><sup>1/4</sup></button>
                                        <button class="quantum-gate" id="pxi-14-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>x</sub><sup>-1/4</sup></button>
                                        <button class="quantum-gate" id="pyi-14-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>y</sub><sup>-1/4</sup></button>
                                        <button class="quantum-gate" id="pzi-14-builtInGate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">P<sub>z</sub><sup>-1/4</sup></button>
                                    </div>
                                </div>

                                <!-- Custom Gates -->
                                <div style="margin-bottom: 20px;">
                                    <h5 style="color: #fff; margin-bottom: 10px; font-size: 14px;">Custom Gates</h5>
                                    <div style="display: grid; grid-template-columns: repeat(1, 1fr); gap: 5px;">
                                        <button class="quantum-gate" id="custom-gate" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 3px; font-size: 12px; cursor: pointer;">+</button>
                                    </div>
                                </div>

                                <!-- Lambda Gates -->
                                <div style="margin-bottom: 20px;">
                                    <h5 style="color: #fff; margin-bottom: 10px; font-size: 14px;">Lambda Gates</h5>
                                    <div style="margin-bottom: 10px;">
                                        <label style="color: #fff; font-size: 12px; display: block; margin-bottom: 5px;">Polar angle: <span id="polar-angle-value">0</span></label>
                                        <input type="range" id="polar-angle" min="0" max="360" value="0" style="width: 100%; height: 4px; border-radius: 2px; background: #333; outline: none;">
                                    </div>
                                    <button id="apply-lambda" style="background: #3b82f6; color: white; border: none; padding: 8px 16px; border-radius: 3px; width: 100%; font-size: 12px; cursor: pointer;">APPLY</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 3D Quantum Circuit Widget -->
            <div class="widget fade-in" data-widget="circuit">
                <div class="widget-header">
                    <h3 class="widget-title">
                        <i class="fas fa-cube"></i>
                        3D Quantum Circuit
                    </h3>
                    <div class="widget-controls">
                        <button class="widget-btn" data-action="refresh" title="Refresh">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="popup" title="Popup View">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="widget-btn" data-action="fullscreen" title="Fullscreen">
                            <i class="fas fa-external-link-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="remove" title="Remove">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="widget-content">
                    <div class="loading" id="circuit-loading">
                        <div class="spinner"></div>
                        <span>Loading 3D circuit...</span>
                    </div>
                    <div class="visualization-container" id="circuit-content" style="display: none;">
                        <!-- 3D Circuit visualization will be rendered here -->
                        <div id="3d-quantum-circuit" style="width: 100%; height: 300px; position: relative;"></div>
                    </div>
                </div>
            </div>

            <!-- Entanglement Analysis Widget -->
            <div class="widget fade-in" data-widget="entanglement">
                <div class="widget-header">
                    <h3 class="widget-title">
                        <i class="fas fa-link"></i>
                        Entanglement Analysis
                    </h3>
                    <div class="widget-controls">
                        <button class="widget-btn" data-action="refresh" title="Refresh">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="popup" title="Popup View">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="widget-btn" data-action="fullscreen" title="Fullscreen">
                            <i class="fas fa-external-link-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="remove" title="Remove">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="widget-content">
                    <div class="loading" id="entanglement-loading">
                        <div class="spinner"></div>
                        <span>Loading entanglement data...</span>
                    </div>
                    <div id="entanglement-content" style="display: none;">
                        <!-- Entanglement analysis will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Results Widget -->
            <div class="widget fade-in" data-widget="results">
                <div class="widget-header">
                    <h3 class="widget-title">
                        <i class="fas fa-chart-bar"></i>
                        Measurement Results
                    </h3>
                    <div class="widget-controls">
                        <button class="widget-btn" data-action="refresh" title="Refresh">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="popup" title="Popup View">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="widget-btn" data-action="fullscreen" title="Fullscreen">
                            <i class="fas fa-external-link-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="remove" title="Remove">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="widget-content">
                    <div class="loading" id="results-loading">
                        <div class="spinner"></div>
                        <span>Loading measurement results...</span>
                    </div>
                    <div id="results-content" style="display: none;">
                        <!-- Results will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Quantum State Widget -->
            <div class="widget fade-in" data-widget="quantum-state">
                <div class="widget-header">
                    <h3 class="widget-title">
                        <i class="fas fa-atom"></i>
                        Quantum State
                    </h3>
                    <div class="widget-controls">
                        <button class="widget-btn" data-action="refresh" title="Refresh">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="popup" title="Popup View">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="widget-btn" data-action="fullscreen" title="Fullscreen">
                            <i class="fas fa-external-link-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="remove" title="Remove">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="widget-content">
                    <div class="loading" id="quantum-state-loading">
                        <div class="spinner"></div>
                        <span>Loading quantum state...</span>
                    </div>
                    <div id="quantum-state-content" style="display: none;">
                        <!-- Quantum state will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Performance Metrics Widget -->
            <div class="widget fade-in" data-widget="performance">
                <div class="widget-header">
                    <h3 class="widget-title">
                        <i class="fas fa-chart-line"></i>
                        Performance
                    </h3>
                    <div class="widget-controls">
                        <button class="widget-btn" data-action="refresh" title="Refresh">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="popup" title="Popup View">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="widget-btn" data-action="fullscreen" title="Fullscreen">
                            <i class="fas fa-external-link-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="remove" title="Remove">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="widget-content">
                    <div class="loading" id="performance-loading">
                        <div class="spinner"></div>
                        <span>Loading performance data...</span>
                    </div>
                    <div id="performance-content" style="display: none;">
                        <!-- Performance charts will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- AI Chat Widget -->
            <div class="widget fade-in" data-widget="ai-chat">
                <div class="widget-header">
                    <h3 class="widget-title">
                        <i class="fas fa-robot"></i>
                        AI Assistant
                    </h3>
                    <div class="widget-controls">
                        <button class="widget-btn" data-action="refresh" title="Refresh">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="popup" title="Popup View">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="widget-btn" data-action="fullscreen" title="Fullscreen">
                            <i class="fas fa-external-link-alt"></i>
                        </button>
                        <button class="widget-btn" data-action="remove" title="Remove">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="widget-content">
                    <div class="loading" id="ai-chat-loading">
                        <div class="spinner"></div>
                        <span>Initializing AI assistant...</span>
                    </div>
                    <div id="ai-chat-content" style="display: none;">
                        <!-- AI Chat interface will be loaded here -->
                        <div class="chat-container">
                            <div class="chat-messages" id="chat-messages">
                                <div class="message ai-message">
                                    <div class="message-content">
                                        <i class="fas fa-robot"></i>
                                        Hello! I'm your quantum computing AI assistant. Ask me anything about quantum states, circuits, or quantum computing concepts!
                                    </div>
                                </div>
                            </div>
                            <div class="chat-input-container">
                                <input type="text" id="chat-input" placeholder="Ask about quantum computing..." class="chat-input">
                                <button id="send-message" class="send-btn">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Popup Modal -->
    <div class="popup-overlay" id="popup-overlay">
        <div class="popup-modal">
            <div class="popup-header">
                <h3 id="popup-title">Widget View</h3>
                <button class="popup-close" id="popup-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="popup-content" id="popup-content">
                <!-- Popup content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Customization Panel -->
    <div class="customization-panel" id="customization-panel">
        <div class="customization-header">
            <h3>Customize Dashboard</h3>
            <button class="widget-btn" id="close-customization">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="customization-content">
            <h4>Available Widgets</h4>
            <ul class="widget-list" id="available-widgets">
                <li class="widget-item" data-widget="backends">
                    <span><i class="fas fa-server"></i> Quantum Backends</span>
                    <button class="widget-btn" data-action="add">
                        <i class="fas fa-plus"></i>
                    </button>
                </li>
                <li class="widget-item" data-widget="jobs">
                    <span><i class="fas fa-tasks"></i> Quantum Jobs</span>
                    <button class="widget-btn" data-action="add">
                        <i class="fas fa-plus"></i>
                    </button>
                </li>
                <li class="widget-item" data-widget="bloch-sphere">
                    <span><i class="fas fa-globe"></i> 3D Bloch Sphere (Blochy)</span>
                    <button class="widget-btn" data-action="add">
                        <i class="fas fa-plus"></i>
                    </button>
                </li>
                <li class="widget-item" data-widget="circuit">
                    <span><i class="fas fa-cube"></i> 3D Quantum Circuit</span>
                    <button class="widget-btn" data-action="add">
                        <i class="fas fa-plus"></i>
                    </button>
                </li>
                <li class="widget-item" data-widget="entanglement">
                    <span><i class="fas fa-link"></i> Entanglement Analysis</span>
                    <button class="widget-btn" data-action="add">
                        <i class="fas fa-plus"></i>
                    </button>
                </li>
                <li class="widget-item" data-widget="results">
                    <span><i class="fas fa-chart-bar"></i> Measurement Results</span>
                    <button class="widget-btn" data-action="add">
                        <i class="fas fa-plus"></i>
                    </button>
                </li>
                <li class="widget-item" data-widget="quantum-state">
                    <span><i class="fas fa-atom"></i> Quantum State</span>
                    <button class="widget-btn" data-action="add">
                        <i class="fas fa-plus"></i>
                    </button>
                </li>
                <li class="widget-item" data-widget="performance">
                    <span><i class="fas fa-chart-line"></i> Performance</span>
                    <button class="widget-btn" data-action="add">
                        <i class="fas fa-plus"></i>
                    </button>
                </li>
                <li class="widget-item" data-widget="ai-chat">
                    <span><i class="fas fa-robot"></i> AI Assistant</span>
                    <button class="widget-btn" data-action="add">
                        <i class="fas fa-plus"></i>
                    </button>
                </li>
            </ul>
        </div>
    </div>

    <!-- Tutorial System -->
    <div class="tutorial-overlay" id="tutorial-overlay">
        <div class="tutorial-highlight" id="tutorial-highlight"></div>
        <div class="tutorial-tooltip" id="tutorial-tooltip">
            <div class="tutorial-header">
                <h3 class="tutorial-title" id="tutorial-title">Welcome to Quantum Spark!</h3>
                <span class="tutorial-step-counter" id="tutorial-step-counter">Step 1 of 8</span>
            </div>
            <div class="tutorial-content" id="tutorial-content">
                Welcome to your Quantum Computing Dashboard! This tutorial will guide you through all the amazing features available in Quantum Spark.
            </div>
            <div class="tutorial-navigation">
                <button class="tutorial-btn secondary" id="tutorial-skip">
                    <i class="fas fa-times"></i>
                    Skip Tutorial
                </button>
                <div class="tutorial-progress">
                    <div class="tutorial-progress-bar" id="tutorial-progress-bar"></div>
                </div>
                <button class="tutorial-btn primary" id="tutorial-prev" disabled>
                    <i class="fas fa-chevron-left"></i>
                    Previous
                </button>
                <button class="tutorial-btn primary" id="tutorial-next">
                    Next
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <!-- Math.js for quantum calculations -->
    <script src="https://unpkg.com/mathjs@11.11.0/lib/browser/math.min.js"></script>
    
    <!-- Blochy Integration -->
    <script src="/static/quantum.js"></script>
    <script src="/static/plot.js"></script>
    <script src="/static/ui.js"></script>
    <script src="/static/helper.js"></script>
    
    <!-- 3D Circuit -->
    <script src="/static/3d_quantum_circuit.js"></script>

    <!-- Enhanced Bloch Integration -->
    <script src="/static/bloch_quantum.js"></script>
    <script src="/static/bloch_ui.js"></script>

    <!-- Three.js Scripts -->
    <script src="/static/bloch_sphere/src/libs/three/three.min.js"></script>

    <!-- Load Three.js Controls -->
    <script>
        // Load OrbitControls from CDN (compatible with global THREE)
        const orbitScript = document.createElement('script');
        orbitScript.src = 'https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js';
        orbitScript.onload = function() {
            console.log('OrbitControls loaded');
            window.OrbitControlsLoaded = true;
        };
        orbitScript.onerror = function() {
            console.error(' Failed to load OrbitControls');
        };
        document.head.appendChild(orbitScript);
    </script>

    <!-- Theme Switcher -->
    <script src="/static/theme_switcher.js"></script>
    
    <!-- Notifications helper -->
    <script src="/static/enhanced_notifications.js"></script>
    
    <!-- Main Dashboard Script -->
    <!-- Quantum Backend Predictor -->
    <script src="/static/quantum_backend_predictor.js"></script>
    
    <!-- Main Dashboard Script -->
    <script src="/static/hackathon_dashboard.js"></script>
    
    <!-- Backend Comparison (Compare button + modal) -->
    <script src="static/backend_comparison.js"></script>

    <!-- Offline Status Management -->
    <script>
        // Offline status management for hackathon dashboard
        document.addEventListener('DOMContentLoaded', async () => {
            const connectionStatus = document.querySelector('.connection-status') || createConnectionStatus();
            const statusIcon = connectionStatus.querySelector('i');
            const statusText = connectionStatus.querySelector('span');

            // Wait for offline manager to initialize
            let offlineManager;
            const checkOfflineManager = setInterval(() => {
                if (window.offlineManager) {
                    offlineManager = window.offlineManager;
                    clearInterval(checkOfflineManager);
                    initializeOfflineStatus();
                }
            }, 100);

            function createConnectionStatus() {
                // Create connection status if it doesn't exist
                const header = document.querySelector('.header-center') || document.querySelector('header');
                if (!header) return null;

                const statusDiv = document.createElement('div');
                statusDiv.className = 'connection-status';
                statusDiv.innerHTML = '<i class="fas fa-circle"></i> <span>Checking connection...</span>';
                header.appendChild(statusDiv);
                return statusDiv;
            }

            function initializeOfflineStatus() {
                updateConnectionStatus();
                setupOfflineNotifications();

                // Update status periodically
                setInterval(updateConnectionStatus, 30000);
            }

            function updateConnectionStatus() {
                if (!offlineManager || !connectionStatus) return;

                const isOnline = offlineManager.isOnlineStatus();

                if (isOnline) {
                    connectionStatus.className = 'connection-status';
                    if (statusIcon) statusIcon.className = 'fas fa-circle';
                    if (statusText) statusText.textContent = 'Connected to IBM Quantum';
                } else {
                    connectionStatus.className = 'connection-status offline';
                    if (statusIcon) statusIcon.className = 'fas fa-circle';
                    if (statusText) statusText.textContent = 'Offline Mode - Using Cached Data';
                }
            }

            function setupOfflineNotifications() {
                if (offlineManager) {
                    checkDataFreshness();
                }
            }

            async function checkDataFreshness() {
                try {
                    const response = await fetch('/api/sync_status');
                    const data = await response.json();

                    if (data.success) {
                        const isFresh15 = data.is_data_fresh_15min;
                        const isFresh30 = data.is_data_fresh_30min;

                        if (!isFresh15 && !isFresh30) {
                            showOfflineNotification(
                                'Data is stale',
                                'Your cached data is more than 30 minutes old. Connect to internet for fresh data.',
                                'warning'
                            );
                        } else if (!isFresh15) {
                            showOfflineNotification(
                                'Data is getting old',
                                'Your cached data is more than 15 minutes old.',
                                'info'
                            );
                        }
                    }
                } catch (error) {
                    console.log('Could not check data freshness:', error);
                }
            }

            function showOfflineNotification(title, message, type = 'info') {
                const existing = document.querySelectorAll('.offline-notification');
                existing.forEach(el => el.remove());

                const notification = document.createElement('div');
                notification.className = `offline-notification ${type} show`;
                notification.innerHTML = `
                    <button class="close-btn" onclick="this.parentElement.remove()">&times;</button>
                    <h4 style="margin: 0 0 8px 0; color: var(--text-primary);">${title}</h4>
                    <p style="margin: 0; color: var(--text-secondary); font-size: 14px;">${message}</p>
                `;

                document.body.appendChild(notification);

                setTimeout(() => {
                    if (notification.parentElement) {
                        notification.remove();
                    }
                }, 10000);
            }

            // Add offline status button to header
            const headerRight = document.querySelector('.header-right');
            if (headerRight) {
                const offlineBtn = document.createElement('button');
                offlineBtn.className = 'btn btn-secondary';
                offlineBtn.innerHTML = '<i class="fas fa-wifi"></i> <span>Offline Status</span>';
                offlineBtn.onclick = () => {
                    window.open('/offline_status', '_blank');
                };
                headerRight.appendChild(offlineBtn);
            }
        });
    </script>

    <!-- Tutorial System Script -->
    <script>
        class TutorialSystem {
            constructor() {
                this.currentStep = 0;
                this.isActive = false;
                this.steps = [
                    {
                        title: "Welcome to Quantum Spark!",
                        content: "Welcome to your Quantum Computing Dashboard! This tutorial will guide you through all the amazing features available in Quantum Spark. Let's explore what makes this dashboard special.",
                        target: null,
                        position: "center"
                    },
                    {
                        title: "Header Controls",
                        content: "This header contains important controls: the connection status shows if you're connected to IBM Quantum, the Theme button lets you customize the appearance, and the Customize button allows you to add/remove dashboard widgets.",
                        target: ".header-center",
                        position: "bottom"
                    },
                    {
                        title: "Metrics Overview",
                        content: "These cards show real-time statistics about your quantum computing resources. You can see the number of active backends, total jobs, running jobs, and success rates at a glance.",
                        target: ".metrics-grid",
                        position: "bottom"
                    },
                    {
                        title: "AI Assistant Panel",
                        content: "Ask questions about quantum computing concepts, circuit design, or any quantum-related topic. The AI assistant powered by Google Gemini will help you understand complex quantum concepts.",
                        target: ".ai-panel",
                        position: "bottom"
                    },
                    {
                        title: "3D Bloch Sphere Widget",
                        content: "This interactive 3D visualization shows quantum states on the Bloch sphere. Use the toolbox on the right to apply quantum gates and see how they transform the quantum state in real-time.",
                        target: "[data-widget='bloch-sphere']",
                        position: "top"
                    },
                    {
                        title: "Quantum Jobs Widget",
                        content: "Monitor all your quantum jobs in real-time. Track their status, execution time, and results. Use the widget controls to refresh, view in popup, or remove the widget.",
                        target: "[data-widget='jobs']",
                        position: "top"
                    },
                    {
                        title: "Widget Controls",
                        content: "Each widget has control buttons: Refresh () to update data, Expand () for popup view, External Link () for fullscreen, and Remove () to hide the widget.",
                        target: "[data-widget='backends'] .widget-controls",
                        position: "left"
                    },
                    {
                        title: "Customization Panel",
                        content: "Click the Customize button in the header to access the customization panel. Here you can add new widgets to your dashboard or remove existing ones to create your perfect workspace.",
                        target: "#customize-btn",
                        position: "bottom"
                    }
                ];

                this.init();
            }

            init() {
                // Add event listener to tutorials button
                document.getElementById('tutorials-btn').addEventListener('click', () => {
                    this.startTutorial();
                });

                // Add event listeners for tutorial controls
                document.getElementById('tutorial-next').addEventListener('click', () => {
                    this.nextStep();
                });

                document.getElementById('tutorial-prev').addEventListener('click', () => {
                    this.previousStep();
                });

                document.getElementById('tutorial-skip').addEventListener('click', () => {
                    this.endTutorial();
                });

                // Close tutorial on overlay click
                document.getElementById('tutorial-overlay').addEventListener('click', (e) => {
                    if (e.target.id === 'tutorial-overlay') {
                        this.endTutorial();
                    }
                });

                // Handle window resize to reposition tutorial
                window.addEventListener('resize', () => {
                    if (this.isActive) {
                        this.positionElements(this.steps[this.currentStep]);
                    }
                });

                // Handle keyboard navigation
                document.addEventListener('keydown', (e) => {
                    if (!this.isActive) return;

                    if (e.key === 'Escape') {
                        this.endTutorial();
                    } else if (e.key === 'ArrowRight' && !document.getElementById('tutorial-next').disabled) {
                        this.nextStep();
                    } else if (e.key === 'ArrowLeft' && !document.getElementById('tutorial-prev').disabled) {
                        this.previousStep();
                    }
                });
            }

            startTutorial() {
                this.currentStep = 0;
                this.isActive = true;
                this.showTutorial();
                document.getElementById('tutorial-overlay').classList.add('active');
            }

            endTutorial() {
                this.isActive = false;
                document.getElementById('tutorial-overlay').classList.remove('active');
                document.getElementById('tutorial-tooltip').classList.remove('active');
                document.getElementById('tutorial-highlight').style.display = 'none';
            }

            showTutorial() {
                const step = this.steps[this.currentStep];

                // Update content
                document.getElementById('tutorial-title').textContent = step.title;
                document.getElementById('tutorial-content').textContent = step.content;
                document.getElementById('tutorial-step-counter').textContent =
                    `Step ${this.currentStep + 1} of ${this.steps.length}`;

                // Update progress bar
                const progress = ((this.currentStep + 1) / this.steps.length) * 100;
                document.getElementById('tutorial-progress-bar').style.width = progress + '%';

                // Update navigation buttons
                document.getElementById('tutorial-prev').disabled = this.currentStep === 0;
                document.getElementById('tutorial-next').textContent =
                    this.currentStep === this.steps.length - 1 ? 'Finish' : 'Next';
                document.getElementById('tutorial-next').innerHTML =
                    this.currentStep === this.steps.length - 1 ?
                    'Finish' :
                    'Next <i class="fas fa-chevron-right"></i>';

                // Position highlight and tooltip
                this.positionElements(step);

                // Show tooltip with animation
                setTimeout(() => {
                    document.getElementById('tutorial-tooltip').classList.add('active');
                }, 100);
            }

            positionElements(step) {
                const highlight = document.getElementById('tutorial-highlight');
                const tooltip = document.getElementById('tutorial-tooltip');

                if (step.target) {
                    const targetElement = document.querySelector(step.target);
                    if (targetElement) {
                        const rect = targetElement.getBoundingClientRect();
                        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                        const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;

                        // Position highlight
                        highlight.style.display = 'block';
                        highlight.style.top = (rect.top + scrollTop - 8) + 'px';
                        highlight.style.left = (rect.left + scrollLeft - 8) + 'px';
                        highlight.style.width = (rect.width + 16) + 'px';
                        highlight.style.height = (rect.height + 16) + 'px';

                        // Position tooltip based on position preference - responsive sizing
                        let tooltipWidth = 500;
                        let tooltipHeight = 280;

                        // Adjust size based on screen width
                        if (window.innerWidth <= 480) {
                            tooltipWidth = 300;
                            tooltipHeight = 220;
                        } else if (window.innerWidth <= 768) {
                            tooltipWidth = 380;
                            tooltipHeight = 240;
                        } else if (window.innerWidth <= 1024) {
                            tooltipWidth = 450;
                            tooltipHeight = 260;
                        }
                        let tooltipTop, tooltipLeft;

                        switch (step.position) {
                            case 'top':
                                tooltipTop = rect.top + scrollTop - tooltipHeight - 30;
                                tooltipLeft = rect.left + scrollLeft + (rect.width / 2) - (tooltipWidth / 2);
                                tooltip.className = 'tutorial-tooltip top';
                                break;
                            case 'bottom':
                                tooltipTop = rect.bottom + scrollTop + 30;
                                tooltipLeft = rect.left + scrollLeft + (rect.width / 2) - (tooltipWidth / 2);
                                tooltip.className = 'tutorial-tooltip bottom';
                                break;
                            case 'left':
                                tooltipTop = rect.top + scrollTop + (rect.height / 2) - (tooltipHeight / 2);
                                tooltipLeft = rect.left + scrollLeft - tooltipWidth - 30;
                                tooltip.className = 'tutorial-tooltip left';
                                break;
                            case 'right':
                                tooltipTop = rect.top + scrollTop + (rect.height / 2) - (tooltipHeight / 2);
                                tooltipLeft = rect.right + scrollLeft + 30;
                                tooltip.className = 'tutorial-tooltip right';
                                break;
                        }

                        // Ensure tooltip stays within viewport with better margins
                        const margin = 40;
                        if (tooltipLeft < margin) tooltipLeft = margin;
                        if (tooltipLeft + tooltipWidth > window.innerWidth - margin) {
                            tooltipLeft = window.innerWidth - tooltipWidth - margin;
                        }
                        if (tooltipTop < margin) tooltipTop = margin;
                        if (tooltipTop + tooltipHeight > window.innerHeight - margin) {
                            tooltipTop = window.innerHeight - tooltipHeight - margin;
                        }

                        tooltip.style.top = tooltipTop + 'px';
                        tooltip.style.left = tooltipLeft + 'px';
                        tooltip.style.transform = 'scale(0.9) translateY(30px)';
                    }
                } else {
                    // Center position for welcome screen
                    highlight.style.display = 'none';
                    tooltip.className = 'tutorial-tooltip';
                    tooltip.style.top = '50%';
                    tooltip.style.left = '50%';
                    tooltip.style.transform = 'translate(-50%, -50%) scale(0.9)';
                }
            }

            nextStep() {
                if (this.currentStep < this.steps.length - 1) {
                    this.currentStep++;
                    this.showTutorial();
                } else {
                    this.endTutorial();
                    this.showCompletionMessage();
                }
            }

            previousStep() {
                if (this.currentStep > 0) {
                    this.currentStep--;
                    this.showTutorial();
                }
            }

            showCompletionMessage() {
                // Show a completion notification
                const notification = {
                    type: 'success',
                    title: 'Tutorial Completed!',
                    message: 'Great! You now know how to use Quantum Spark. Feel free to explore all the features and start your quantum computing journey!',
                    duration: 5000
                };

                // You can integrate this with your existing notification system
                if (window.showNotification) {
                    window.showNotification(notification);
                } else {
                    alert(notification.message);
                }
            }
        }

        // Initialize tutorial system when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new TutorialSystem();
        });
    </script>

    <!-- API Instance Configuration Modal -->
    <div id="api-config-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 style="margin: 0; color: var(--text-primary);">
                    <i class="fas fa-plus-circle"></i>
                    Add IBM Quantum API
                </h3>
                <button class="modal-close" onclick="closeApiConfigModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="api-config-form">
                    <div class="form-group" style="margin-bottom: 1.5rem;">
                        <label for="api-token" style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">
                            IBM Quantum API Token
                        </label>
                        <input type="password" id="api-token" name="apiToken" placeholder="Enter your API token here" required
                               style="width: 100%; padding: 0.75rem; border: 1px solid var(--glass-border); border-radius: var(--border-radius); background: var(--glass-bg); color: var(--text-primary); font-family: var(--font-mono); font-size: 0.9rem;">
                    </div>

                    <div class="form-group" style="margin-bottom: 1.5rem;">
                        <label for="api-crn" style="display: block; margin-bottom: 0.5rem; color: var(--text-primary); font-weight: 500;">
                            IBM Cloud CRN (Optional)
                        </label>
                        <input type="text" id="api-crn" name="apiCrn" placeholder="Enter your CRN if using IBM Cloud"
                               style="width: 100%; padding: 0.75rem; border: 1px solid var(--glass-border); border-radius: var(--border-radius); background: var(--glass-bg); color: var(--text-primary); font-family: var(--font-family);">
                        <small style="color: var(--text-secondary); font-size: 0.8rem; margin-top: 0.25rem; display: block;">
                            If you're using IBM Cloud Quantum, provide your CRN for better connection
                        </small>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closeApiConfigModal()">
                    <i class="fas fa-times"></i>
                    Cancel
                </button>
                <button type="button" class="btn-primary" onclick="addApiInstance()">
                    <i class="fas fa-plus-circle"></i>
                    Add IBM Quantum API
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Styles -->
    <style>
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-deep);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--glass-border);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        .btn-primary, .btn-secondary {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--border-radius);
            font-family: var(--font-family);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(6, 182, 212, 0.3);
        }

        .btn-secondary {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--text-accent);
            box-shadow: 0 0 0 2px rgba(6, 182, 212, 0.2);
        }

        /* Notification animations */
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }
    </style>

</body>
</html>